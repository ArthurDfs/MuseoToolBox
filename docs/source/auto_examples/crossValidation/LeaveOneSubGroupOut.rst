.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_auto_examples_crossValidation_LeaveOneSubGroupOut.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_crossValidation_LeaveOneSubGroupOut.py:


Leave-One-SubGroup-Out (LOSGO)
======================================================

This example shows how to make a Leave-One-SubGroup-Out.



Import librairies
-------------------------------------------



.. code-block:: python


    from MuseoToolBox.crossValidationTools import LeaveOneSubGroupOut
    from MuseoToolBox.rasterTools import getSamplesFromROI
    from MuseoToolBox import datasets







Load HistoricalMap dataset
-------------------------------------------



.. code-block:: python


    raster,vector = datasets.getHistoricalMap()
    field = 'Class'
    group = 'uniquefid'
    X,y,s = getSamplesFromROI(raster,vector,field,group)






Create CV
-------------------------------------------



.. code-block:: python


    valid_size = 0.5 # Means 50%
    LOSGO = LeaveOneSubGroupOut(verbose=False,random_state=12)







.. note::
   There is no need to specify a bandPrefix. 
   If bandPrefix is not specified, scipt will only generate the centroid



.. code-block:: python

    LOSGO.get_n_splits(X,y,s)
    for tr,vl in LOSGO.split(X,y,s):
        print(tr.shape,vl.shape)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    (9394,) (3253,)
    (10180,) (2467,)


Differences with sklearn
-------------------------------------------
Sklearn do not use subgroups
as MuseoToolBox use one group per Y label    



.. code-block:: python

    from sklearn.model_selection import LeaveOneGroupOut

    LOGO = LeaveOneGroupOut()
    for tr,vl in LOGO.split(X=X,y=y,groups=s):
        print(tr.shape,vl.shape)
    # Plot example in image
    
    import numpy as np
    from matplotlib import pyplot as plt
    plt.scatter(np.random.randint(10,30,40),np.random.randint(10,30,40),s=100,color='#1f77b4')
    plt.scatter(np.random.randint(0,10,40),np.random.randint(10,30,40),s=100,color='#1f77b4')
    plt.scatter(np.random.randint(0,10,20),np.random.randint(0,10,20),s=100,color='#ff7f0e')
    plt.axis('off')
    plt.show()


.. image:: /auto_examples/crossValidation/images/sphx_glr_LeaveOneSubGroupOut_001.png
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    (11166,) (1481,)
    (11511,) (1136,)
    (12125,) (522,)
    (10323,) (2324,)
    (12116,) (531,)
    (11686,) (961,)
    (12382,) (265,)
    (11434,) (1213,)
    (11781,) (866,)
    (12111,) (536,)
    (12262,) (385,)
    (12641,) (6,)
    (12507,) (140,)
    (12645,) (2,)
    (11711,) (936,)
    (12149,) (498,)
    (11802,) (845,)


**Total running time of the script:** ( 0 minutes  0.218 seconds)


.. _sphx_glr_download_auto_examples_crossValidation_LeaveOneSubGroupOut.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: LeaveOneSubGroupOut.py <LeaveOneSubGroupOut.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: LeaveOneSubGroupOut.ipynb <LeaveOneSubGroupOut.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
