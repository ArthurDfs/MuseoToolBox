.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_auto_examples_cross_validation_LeaveOneOutPerClass.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_cross_validation_LeaveOneOutPerClass.py:


Leave One Out Per Class (LOOPC)
======================================================

This example shows how to make a Leave One Out for each class.



Import librairies
-------------------------------------------



.. code-block:: python


    from museotoolbox.cross_validation import LeaveOneOutPerClass
    from museotoolbox import datasets







Load HistoricalMap dataset
-------------------------------------------



.. code-block:: python


    X,y = datasets.historicalMap(return_X_y=True)







Create CV
-------------------------------------------



.. code-block:: python

    LOOPC = LeaveOneOutPerClass(random_state=8,verbose=False)
    for tr,vl in LOOPC.split(X=None,y=y):
        print(tr,vl)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [ 1599  1600  1601 ...,  9560  9561 10321] [ 6183  8386  2217  8824 10322]
    [ 1599  1600  1601 ...,  9560 10321 10322] [12584  1472   832  8885  9561]
    [ 1599  1600  1601 ...,  9561 10321 10322] [3488 1409 2733 8843 9508]
    [ 1599  1600  1601 ...,  9561 10321 10322] [1838  721 2874 9002 9509]
    [ 1599  1600  1601 ...,  9561 10321 10322] [6302 1550 2814 8964 9457]
    [ 1599  1600  1601 ...,  9561 10321 10322] [3808  677 2899 9135 9560]
    [ 1599  1600  1601 ...,  9561 10321 10322] [ 3487 10243  2828  1291  9458]
    [ 1599  1600  1601 ...,  9560  9561 10322] [ 3988  8369   690  8979 10321]


.. note::
   Split is made to generate each fold



.. code-block:: python


    # Show label

    for tr,vl in LOOPC.split(X=None,y=y):
        print(y[vl])
    
        



.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [1 2 3 4 5]
    [1 2 3 4 5]
    [1 2 3 4 5]
    [1 2 3 4 5]
    [1 2 3 4 5]
    [1 2 3 4 5]
    [1 2 3 4 5]
    [1 2 3 4 5]


**Total running time of the script:** ( 0 minutes  0.086 seconds)


.. _sphx_glr_download_auto_examples_cross_validation_LeaveOneOutPerClass.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: LeaveOneOutPerClass.py <LeaveOneOutPerClass.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: LeaveOneOutPerClass.ipynb <LeaveOneOutPerClass.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
